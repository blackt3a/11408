## 计算机网络分层结构

为了方便维护，研究，促进标准化

#### 分层的原则

- 每层相互独立
- 界面(边界)自然清晰，易于理解
- 每层功能的==定义==与==实现==独立(想换就换)
- 下层向上层==提供服务==的同时有==独立==性
- 每层都实现各自的标准化

注意，层数越多，功能越清晰(理论上更好)，但效率也会更低(实际使用)



#### 分层后的特点

- 每一层的报文都含用==服务数据单元==(SDU)和==协议控制信息==(PCI)，共同组成==协议数据单元==(PDU)

- 结点间，==对等==层在==逻辑==上有一条==直接通道==

- 上层==能也只能==通过下层的接口，使用服务(不能越层)。

- 下层实现的细节对上层==透明==
- 某一层对上上层提供的服务是该层和下层所有服务的==总和==



## 计算机网络协议，接口，服务的概念

#### 协议

协议是规则的==集合==。而这些规则是为==交换==而建立的

只有==对等==实体间才有协议



协议由==语法==，==语义==和==同步==三部分组成：

- 语法规定了==格式==
- 语义规定了==动作==
- 同步规定了==时序==

完整的协议应该有==线路管理==，==差错控制==，==数据转换==等功能

#### 接口

相邻层信息的连接点，每层只为相邻层提供接口，用于==向上==提供服务



#### 服务

服务是指下层为上层提供的==功能调用==。

上层在使用下层服务时，需要交换一些==命令==(服务原语)

- 请求
- 指示
- 响应
- 证实

有应答服务会包含==全部==4类原语，无应答服务只有请求和指示==两类==原语

![_-170232269__235f5368c96c051fcfcfd60f5dd85ac4_-1157030421_Screenshot_20230818_152032_com.jideos.jnotes_0_wifi_0](../pictures/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BD%93%E7%B3%BB%E4%B8%8E%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B.assets/_-170232269__235f5368c96c051fcfcfd60f5dd85ac4_-1157030421_Screenshot_20230818_152032_com.jideos.jnotes_0_wifi_0.jpg)

注意，协议是==水平==的，服务是==垂直==的，==只有==本层协议实现了才能向上提供服务。==只有==能被上一层实体==看得见==的功能才能称的上服务



服务的分类：

- 面向连接服务和无连接服务

  ==是否==有==建立==链接，数据==传输==和连接==释放==三个阶段

- 可靠服务和不可靠服务

  ==是否==有纠错，检错，应答机制

  不可靠服务只是==尽可能==送达，不保证准确

- 有应答服务和无应答服务

  接收方在受到数据后==是否==给出相应的==应答==(可以是肯定的，也可以是否定的)

  例如==文件传输==(FTP)是有应答的服务，www是无应答服务。





## ISO/OSI参考模型和TCP/IP模型

#### OSI参考模型

一般将低三层视为==通信子网==，高三层视为==资源子网==

- 应用层

  最高层，用户与网络的界面，是==最复杂==的一层，使用的协议==最多==

  文件传输(FTP),电子邮件(SMTP),万维网的(HTTP)

- 表示层

  决定两个通信系统中交换信息的==表示方式==。提供编码，数据压缩，加密和解密等==数据变换==功能

- 会话层

  > 负责建立同步

  利用传输层提供==端到端==(端口到端口)服务，为==表示层实体==或==用户进程==建立连接并==有序==传输数据，即会话,也称建立同步(SYN)

  一般提及`同步`则指会话层。

- 传输层

  也称运输层，有`TCP`和`UDP`协议

  > 传输层负责进程间的通信

  提供==端到端==的==可靠==服务。

  有==流量控制==，==差错控制==，==数据传输管理==等服务。

  传输层是==复用==(多个上层可以同时)和==分用==(交付时可以分别)

  注意，数据链路层提供的是==点到点==(主机到主机)的通信

  

- 网络层

  也称网际层和`IP`层

  网络层的协议有，`IP`,`IPX`,`ICMP`,`IGMP`,`ARP`,`RARP`,`OSPF`。

  传输单位是==数据报==。

  关键问题是==路由选择==，并实现==流量控制==，==差错控制==，==拥塞控制==，==网际互联==(不同局域网间互联)

  

- 数据链路层

  将网络层的数据报封装成==帧==。

  功能是==成帧==，==流量控制==，==差错控制==，==传输管理==





- 物理层(也重要，别忽略协议)

  协议有`EIA-232C`，`EIA/TIA RS-449`,`CCITTD的X.21`等

  传输单位是比特(`bit`)，在物理设备上透明传输==比特流==

  物理层主要定义==数据终端设备==(主机)和==数据通信设备==(中间结点)的物理和逻辑连接方法。

  规定了电路接口的==参数==，机械==形状==，针角==数量与排列==等

  注意，物理层利用的传输==介质==(双绞线，光缆，无线电信道等)==并==不在物理层，而在==物理层下面==，所以也有人将==物理媒体==当作第`0`层。







#### TCP/IP模型

- 应用层

  ==用户到用户==

  包含所有高层协议，虚拟终端协议(`Telnet`)，文件传输协议(`FTP`)，域名接些协议(`DNS`)，电子邮件协议(`SMTP`)，超文本传输协议(`HTTP`)

- 传输层

  ==进程到进程==

  传输控制协议(Transmission Control Protocol，`TCP`)

  用户数据报协议(User Datagram Protocol，`UDP`)

- 网际层(与网络层类似)

  定义了标准的分组格式和协议，即`IP`，但也只有`IP`，是`TCP/IP`的网际层很`简单`

- 网络接口层(OSI以下两层的综合)

  - 物理层
  - 数据链路层



#### TCP/IP模型与OSI参考模型的比较

相似：

- 都分层
- 都基于独立的协议栈
- 都解决异构网络的互联

不同：

- `OSI`更精确地定义了==服务==，==协议==和==接口==三个概念

- `OSI`通用性更强，没有偏向，`TCP/IP`协议不适用于其他的协议栈，==通用性差==

- `TCP/IP`设计之初就考虑到了异构网的互联问题，并使用`IP`单独作为一层(网际层)，`OSI`后来才认识到`IP`的重要，则网络层中划分一个子层

- `OSI`在网络层支持==无连接==和面向==有连接==的通信，传输层仅有面向==有连接==的通信（怪怪的）

  `TCP/IP`认为可靠性是端到端(上层解决)的问题，因此网际层==只有无连接==的通信模式

  注意，这是==常考点==

#### 常考与易错

- 关于==流量检测==与==差错控制==：

注意，==不等同==于可靠运输

![_-717146752__7d3f3854813b31fd2537aa5ec29b9a91_1946623660_Screenshot_20230818_164210_com.jideos.jnotes_0_wifi_0](../pictures/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BD%93%E7%B3%BB%E4%B8%8E%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B.assets/_-717146752__7d3f3854813b31fd2537aa5ec29b9a91_1946623660_Screenshot_20230818_164210_com.jideos.jnotes_0_wifi_0.jpg)

- 关于==面向连接==：

主要看`TCP`吧(瞎说的)

![_-2021067793__d00e3ab3b65635d525994d132d35ad07_-1922953809_Screenshot_20230818_164752_com.jideos.jnotes_0_wifi_0](../pictures/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BD%93%E7%B3%BB%E4%B8%8E%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B.assets/_-2021067793__d00e3ab3b65635d525994d132d35ad07_-1922953809_Screenshot_20230818_164752_com.jideos.jnotes_0_wifi_0.jpg)

- 关于拥塞控制：

  `OSI`分在==网络层==，`TCP/IP`没有明确，但应该在传输层

- 关于端到端和点到点的辨析

  通常不认为两者相同，前者一般是==用户==(进程)间，后者一般是==计算机==间





#### 最后

- 由==通信网络==或==终端==负责数据==可靠性==的区别在==成本==，这也是计算机网络能够得到推广的原因。

- 一般链路的传输速度==上限==由其连接连接线路的==物理特性==锁死，人们决定线路速度是通过==调节结点间==的==发送==和==接受==速率

- 如何理解`传输速率`，`带宽`和`传播速率`？

  传输速率是反映信息在信道内的传输速度指标，带宽是传输速度的上限。

  传输速率是传播媒介(光，无限电)的在传输介质中(空气。光纤)的速度。

- 如何理解传输时延，发送时延和传播时延

  ==传输时延==和==发送时延==是同一个意思。指机器发送数据帧的时间，即从发送==第一个==比特(`bit`)到==最后一个==比特(`bit`)所花的==时间==，一般认为机器发送的速度和信号在介质中的传输速度是==相同的==

  所以，

  ​							$发送时延=数据帧长度/信道带宽$

  传播时延是指电磁波在==信道中==所花的时间

  ​							$传播时延=信道长度/信号在信道上的传输速度$

